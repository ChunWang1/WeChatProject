<!--pages/warehouse/warehouse.wxml-->
<import src="../../../template/tabbar.wxml"/>
<template is="tabBar" data="{{tabBar:tabBar}}"></template>
<view>
<!--顶部导航栏-->
<view class="swiper-tab">
 
<view class="tab-item {{currentTab==0 ? 'on' : ''}}" data-current="0" bindtap="swichNav">智慧泥仓</view>
 
<view class="tab-item {{currentTab==1 ? 'on' : ''}}" data-current="1" bindtap="swichNav">污泥出入记录</view>
 
<view class="tab-item {{currentTab==2 ? 'on' : ''}}" data-current="2" bindtap="swichNav">处理记录</view>

</view>

<!--内容主体-->
<swiper class="swiper" current="{{currentTab}}" duration="200" bindchange="swiperChange">
 
<swiper-item>
<form>
<view class="echart-iframe">
  <ec-canvas id="mychart-dom-pie" canvas-id="mychart-pie" ec="{{ ec }}" bind:init="echartInit"></ec-canvas>
</view>
<view class='chart-iframe' wx:for="{{itemList}}" wx:key="{{itemList.name}}" wx:for-item="item">
  <view class='ViewText'>{{item.name}}号仓({{item.moistrueDegree}})</view>
  <view class='testText'>
  <text>总容量：{{item.capacity}}吨</text>
  </view>
  <view class='setting'>
  <image style="width:40rpx;height:40rpx;margin-left:10px;        margin-right:10px;" mode="scaleToFill" src="{{imageSrc2}}"></image>
  <text class='testText'>存储量</text>
    <image style="width:40rpx;height:40rpx;margin-left:10px;        margin-right:10px;"mode="scaleToFill" src="{{imageSrc1}}"></image>
    <text class='testText'>剩余量</text>
  </view>
  <view style='width:100%;height:200rpx'>
    <ec-canvas id="mychart-dom-bar" canvas-id="mychart-bar" tuData="{{item.data}}" ec="{{ ec }}"></ec-canvas>
  </view>
</view>
</form>
<view  wx:if="{{itemList.length==0}}">
<i-load-more tip="暂无数据" loading="{{ false }}"/>
<i-load-more loading="{{ false }}" />
</view>
</swiper-item>
 
<swiper-item>
<!--查询框-->

<!--增加框-->
<view bindtap='addsludge' class="add_iconview">
      <image class="add_icon" src="/resources/addsludge.png"></image>
</view>
<!--增加弹窗-->
<!--弹窗-->
  <view class="modal-mask" bindtap="hideModal" catchtouchmove="preventTouchMove" wx:if="{{showModal}}"></view>
  <view class="modal-dialog" wx:if="{{showModal}}">
    <view class="modal-title">新增污泥块出仓记录</view>
    <view class="modal-content">
      <view class="modal-input">
       <!--<input placeholder-class="input-holder"  bindinput="wareHouseinputChange" class="input" placeholder="泥仓号"></input>-->
        <picker bindchange="bindwarehousePickerChange" range="{{itemList}}" value='{{itemList[warehouseIndex].name}}' class='regSelect' range-key="{{'name'}}" >
        <input class='selectInp'  bindinput="wareHouseinputChange" placeholder="请选择泥仓" name='itemList' disabled='false' value='{{itemList[warehouseIndex].name}}'/> 
      <view class='select'> 
        <image class='select-img'src="/resources/down.png"></image>
      </view>
    </picker>
      </view>
      <view class="modal-input">
        <!--<input placeholder-class="input-holder"  bindinput="transCarinputChange" class="input" placeholder="运输司机"></input>-->
       <picker bindchange="bindtranscarPickerChange" range="{{carrierUnassignList}}" value='{{carrierUnassignList[carIndex].id}}' class='regSelect' range-key="{{'name'}}" >
        <input class='selectInp'  bindinput="transCarinputChange" placeholder="请选择司机" name='carrierUnassign' disabled='false' value='{{carrierUnassignList[carIndex].id}}'/> 
      <view class='select'> 
        <image class='select-img'src="/resources/down.png"></image>
      </view>
    </picker>
      </view>
      <view class="modal-input">
        <input placeholder-class="input-holder"  bindinput="rfidinputChange" class="input" placeholder="RFID"></input>
      </view>
      <view class="modal-input">
        <input placeholder-class="input-holder"  bindinput="desAddrinputChange" class="input" placeholder="目的地"></input>
       </view>
       <view class="modal-input">
        <!--<input placeholder-class="input-holder" bindinput="functioninputChange" class="input" placeholder="用途"></input>--> 
        <picker bindchange="bindfunctionPickerChange" range="{{functionList}}" value='{{functionList[functionIndex].function}}' class='regSelect' range-key="{{'function'}}" >
        <input class='selectInp'  bindinput="functioninputChange" placeholder="请选择用途" name='function' disabled='false' value='{{functionList[functionIndex].function}}'/> 
      <view class='select'> 
        <image class='select-img'src="/resources/down.png"></image>
      </view>
    </picker>
      </view>
         <view class="modal-input">
         <input placeholder-class="input-holder"  bindinput="weightinputChange" class="input" placeholder="重量"></input>
      </view>
    </view>
    <view class="modal-footer">
      <view class="btn-cancel" bindtap="onCancel" data-status="cancel">取消</view>
      <view class="btn-confirm" bindtap="onConfirm" data-status="confirm">确定</view>
    </view>
  </view>

<!--污泥出入记录-->
<block wx:if="{{sludgeList.length!=0}}">
<i-cell-group>
    <i-cell title="状态:"  >
    <i-tag wx:if="{{sludgeList[sludeg_current-1].status==0}}" slot="footer" class="i-tags"   color="yellow"> 未到达</i-tag>
    <i-tag wx:elif="{{sludgeList[sludeg_current-1].status==1}}" slot="footer" class="i-tags"   color="green"> 已到达</i-tag>
    </i-cell>
    <i-cell title="RFID:" value="{{sludgeList[sludeg_current-1].rfidString}}">
    </i-cell>
    <i-cell title="目的地:" value="{{sludgeList[sludeg_current-1].destinationAddress}}">
    </i-cell>
    <i-cell title="污泥块量(吨):" value="{{sludgeList[sludeg_current-1].weight}}">
    </i-cell>
    <i-cell title="污泥运输车司机:" value="{{sludgeList[sludeg_current-1].car.driver.realname}}">
    </i-cell>
    <i-cell title="污泥功能:" value="{{sludgeList[sludeg_current-1].sludgeFunction.function}}">
    </i-cell>
</i-cell-group>
 <i-cell >
 </i-cell>

</block>
 <!--分页--->
<i-page current="{{ sludeg_current }}" total="{{sludgeList.length}}" bind:change="sludgehandleChange">
    <view slot="prev">上一条记录</view>
    <view slot="next">下一条记录</view>
</i-page>
<!--无数据-->
 <view  wx:if="{{sludgeList.length==0}}">
<i-load-more tip="暂无数据" loading="{{ false }}"/>
<i-load-more loading="{{ false }}" />
</view>
</swiper-item>
 

<swiper-item>
 <!--查询-->

 <!--处理记录-->
<block wx:if="{{recordList.length!=0}}" >
<i-cell-group>
    <i-cell title="状态:"  >
    <i-tag wx:if="{{recordList[record_current-1].status==0}}" slot="footer" class="i-tags"   color="green"> 已完成</i-tag>
    <i-tag wx:elif="{{recordList[record_current-1].status==1}}" slot="footer" class="i-tags"   color="blue"> 处理中</i-tag>
    <i-tag wx:elif="{{recordList[record_current-1].status==2}}" slot="footer" class="i-tags"   color="yellow"> 待处理</i-tag>
    </i-cell>
    <i-cell title="处理人:" value="{{recordList[record_current-1].car.driver.realname}}">
    </i-cell>
    <i-cell title="任务分配时间:" value="{{recordList[record_current-1].allocationTime}}">
    </i-cell>
    <i-cell title="产生污泥块量(吨):" value="{{recordList[record_current-1].sludgesWeight}}">
    </i-cell>
</i-cell-group>
<i-collapse-item title="更多详情"  >
    <view slot="content">
    <i-cell title="污泥处理开始时间:" value="{{recordList[record_current-1].disposalTime}}">
    </i-cell>
    <i-cell title="污泥处理完成时间:" value="{{recordList[record_current-1].finishTime}}">
    </i-cell>
    <i-cell title="处理人号码:" value="{{recordList[record_current-1].car.driver.telephone}}">
    </i-cell>   
    <i-cell title="车牌号:" value="{{recordList[record_current-1].car.license}}">
    </i-cell> 
    </view>
</i-collapse-item>
 <i-cell >
 </i-cell>
</block>
<!--分页--->
<i-page current="{{ record_current }}" total="{{recordList.length}}" bind:change="recordhandleChange">
    <view slot="prev">上一条记录</view>
    <view slot="next">下一条记录</view>
</i-page>
<!--暂无数据--->
<view  wx:if="{{recordList.length==0}}">
<i-load-more tip="暂无数据" loading="{{ false }}"/>
<i-load-more loading="{{ false }}" />
</view>
</swiper-item>
 
</swiper>
</view>
